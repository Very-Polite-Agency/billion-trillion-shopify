import Drawers from"drawers";function _regeneratorRuntime(){_regeneratorRuntime=function(){return exports};var exports={},e=Object.prototype,t=e.hasOwnProperty,n=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,r,o){var a=t&&t.prototype instanceof l?t:l,i=Object.create(a.prototype),c=new C(o||[]);return n(i,"_invoke",{value:b(e,r,c)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}exports.wrap=s;var d={};function l(){}function h(){}function m(){}var f={};c(f,o,(function(){return this}));var y=Object.getPrototypeOf,p=y&&y(y(T([])));p&&p!==e&&t.call(p,o)&&(f=p);var v=m.prototype=l.prototype=Object.create(f);function g(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,r){function o(n,a,i,c){var s=u(e[n],e,a);if("throw"!==s.type){var d=s.arg,l=d.value;return l&&"object"==typeof l&&t.call(l,"__await")?r.resolve(l.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):r.resolve(l).then((function(e){d.value=e,i(d)}),(function(e){return o("throw",e,i,c)}))}c(s.arg)}var a;n(this,"_invoke",{value:function(e,t){function n(){return new r((function(n,r){o(e,t,n,r)}))}return a=a?a.then(n,n):n()}})}function b(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return A()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=_(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=u(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function T(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(t.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=void 0,n.done=!0,n};return a.next=a}}return{next:A}}function A(){return{value:void 0,done:!0}}return h.prototype=m,n(v,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:h,configurable:!0}),h.displayName=c(m,i,"GeneratorFunction"),exports.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},exports.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,i,"GeneratorFunction")),e.prototype=Object.create(v),e},exports.awrap=function(e){return{__await:e}},g(w.prototype),c(w.prototype,a,(function(){return this})),exports.AsyncIterator=w,exports.async=function(e,t,n,r,o){void 0===o&&(o=Promise);var a=new w(s(e,t,n,r),o);return exports.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(v),c(v,i,"Generator"),c(v,o,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),exports.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},exports.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&t.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t,r){return i.type="throw",i.arg=e,n.next=t,r&&(n.method="next",n.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=t.call(a,"catchLoc"),s=t.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,n){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&t.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=n&&n<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=n,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},exports}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,c,"next",e)}function c(e){asyncGeneratorStep(a,r,o,i,c,"throw",e)}i(void 0)}))}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var _Theme$drawer$cart,regions=[{name:"Alberta",code:"AB"},{name:"British Columbia",code:"BC"},{name:"Manitoba",code:"MB"},{name:"New Brunswick",code:"NB"},{name:"Newfoundland and Labrador",code:"NL"},{name:"Northwest Territories",code:"NT"},{name:"Nova Scotia",code:"NS"},{name:"Nunavut",code:"NU"},{name:"Ontario",code:"ON"},{name:"Prince Edward Island",code:"PE"},{name:"Quebec",code:"QC"},{name:"Saskatchewan",code:"SK"},{name:"Yukon Territory",code:"YT"},{name:"Alabama",code:"AL"},{name:"Alaska",code:"AK"},{name:"American Samoa",code:"AS"},{name:"Arizona",code:"AZ"},{name:"Arkansas",code:"AR"},{name:"California",code:"CA"},{name:"Colorado",code:"CO"},{name:"Connecticut",code:"CT"},{name:"Delaware",code:"DE"},{name:"District of Columbia",code:"DC"},{name:"Florida",code:"FL"},{name:"Georgia",code:"GA"},{name:"Guam",code:"GU"},{name:"Hawaii",code:"HI"},{name:"Idaho",code:"ID"},{name:"Illinois",code:"IL"},{name:"Indiana",code:"IN"},{name:"Iowa",code:"IA"},{name:"Kansas",code:"KS"},{name:"Kentucky",code:"KY"},{name:"Louisiana",code:"LA"},{name:"Maine",code:"ME"},{name:"Maryland",code:"MD"},{name:"Massachusetts",code:"MA"},{name:"Michigan",code:"MI"},{name:"Minnesota",code:"MN"},{name:"Mississippi",code:"MS"},{name:"Missouri",code:"MO"},{name:"Montana",code:"MT"},{name:"Nebraska",code:"NE"},{name:"Nevada",code:"NV"},{name:"New Hampshire",code:"NH"},{name:"New Jersey",code:"NJ"},{name:"New Mexico",code:"NM"},{name:"New York",code:"NY"},{name:"North Carolina",code:"NC"},{name:"North Dakota",code:"ND"},{name:"Ohio",code:"OH"},{name:"Oklahoma",code:"OK"},{name:"Oregon",code:"OR"},{name:"Pennsylvania",code:"PA"},{name:"Puerto Rico",code:"PR"},{name:"Rhode Island",code:"RI"},{name:"South Carolina",code:"SC"},{name:"South Dakota",code:"SD"},{name:"Tennessee",code:"TN"},{name:"Texas",code:"TX"},{name:"Utah",code:"UT"},{name:"Vermont",code:"VT"},{name:"Virgin Islands",code:"VI"},{name:"Virginia",code:"VA"},{name:"Washington",code:"WA"},{name:"West Virginia",code:"WV"},{name:"Wisconsin",code:"WI"},{name:"Wyoming",code:"WY"}],getCodeFromName=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0;t<regions.length;t++)if(regions[t].name===e)return regions[t].code;return e},Regions={getCodeFromName:getCodeFromName},stockistAddress=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block_name,n=void 0===t?"stockists":t,r=e.address,o=void 0===r?"":r,a=e.address2,i=void 0===a?"":a,c=e.city,s=void 0===c?"":c;e.country;var u=e.name,d=void 0===u?"":u,l=e.postal,h=void 0===l?"":l,m=e.region,f=void 0===m?"":m;return o+=i?", ".concat(i):"",s+=f?", ".concat(Regions.getCodeFromName(f)):"",s+=h?" ".concat(h):"",o||s?'\n      <div class="'.concat(n,'__location-address text--secondary">\n        <a class="').concat(n,'__location-address-link link" href="').concat(stockistDirectionsLink(e),'" target="_blank" title="Directions to ').concat(d,'">\n          ').concat(o?"<span>".concat(o,"</span>"):"","\n          ").concat(s?"<span>".concat(s,"</span>"):"","\n        </a>\n      </div>\n    "):""},stockistDirectionsLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.block_name;var t=e.address,n=void 0===t?"":t;e.address2;var r=e.city,o=void 0===r?"":r,a=e.country,i=void 0===a?"":a,c=e.query,s=void 0===c?"":c,u=e.name,d=void 0===u?"":u,l=e.postal,h=void 0===l?"":l,m=e.region,f=void 0===m?"":m;return s+=null!=n?n:"",s+=o?", ".concat(o):"",s+=f?", ".concat(f):"",s+=h?", ".concat(h):"",s+=i?", ".concat(i):"",s+=d?", ".concat(d):"","https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent(s.trim()))},stockistLocation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block_name,n=void 0===t?"stockists":t,r=e.name,o=void 0===r?"":r;return'\n    <div class="'.concat(n,'__location">\n      ').concat(o?'<strong class="'.concat(n,'__location-name">').concat(o,"</strong>"):"","\n      ").concat(stockistAddress(e),"\n    </div>\n  ")},Templates={stockistLocation:stockistLocation},stockistCountryPopulationGraph=function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=1e3*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),n=e.id||"not-set",r=e.dataset.region||"",o=parseInt(e.dataset.regionPopulation||0),a=(o/t).toFixed(2),i=document.getElementById("".concat(n,"--scale"))||!1,c=Math.ceil(13*a),s="",u=0;u<13;u++)s+='<div class="stockists__region-stats-scale-item'.concat(u<c?" active":"",'"></div>');i.innerHTML=s,i&&console.log({region:r,regionPopulation:o,regionPopulationPercent:a,countryPopulation:t,scalelimit:13,scalePercent:c})},stockistLocationByRegion=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e&&t.length){var n=_toConsumableArray(new Set(t.map((function(e){return e.city})))).sort(),r="";n.length?n.forEach((function(e){var n=t.filter((function(t){return t.city===e})).sort((function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}));if(r+='<h3 class="stockists__city">'.concat(e,"</h3>"),n.length){r+='<div class="stockists__listing">';for(var o=0;o<n.length;o++)r+=Templates.stockistLocation(n[o]);r+="</div>"}})):r='\n        <div class="stockists__error text--align-center body-copy--primary body-copy--2">\n          <p>No stockists for this region yet. Checkback soon!</p>\n        </div>\n      ',e.innerHTML=r}},Render={stockistCountryPopulationGraph:stockistCountryPopulationGraph,stockistLocationByRegion:stockistLocationByRegion},DRAWER_CART_CLOSE_DELAY=(null===(_Theme$drawer$cart=Theme.drawer.cart)||void 0===_Theme$drawer$cart?void 0:_Theme$drawer$cart.delay_close)||3e3,addToCart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e&&fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:e,quantity:t}]})}).then((function(e){return e.json()})).then((function(e){getCart().then((function(e){toggleCheckoutButtonUsability("enable"),Render.cartLineItemsTotal(e.item_count),Render.cartLineItems(e.items),Render.cartSubtotal(e.items_subtotal_price),Drawers.openDrawer("drawer-cart",500),Drawers.closeDrawer("drawer-cart",DRAWER_CART_CLOSE_DELAY)}))})).catch((function(e){console.log("[ addToCart() ] :: Error",e)}))},emptyCart=function(){fetch("/cart/clear.js",{method:"POST"}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.error("[ emptyCart() ] :: Error",e)}))},getCart=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/cart.js",{method:"GET"}).then((function(e){return e.json()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),toggleCheckoutButtonUsability=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"enable";(document.querySelectorAll('button[name="checkout"]')||[]).forEach((function(t){switch(e){case"enable":t.disabled=!1;break;case"disable":t.disabled=!0}}))},init=function(){Theme.cart.items.length?(Render.cartLineItems(Theme.cart.items),toggleCheckoutButtonUsability("enable")):(Render.cartEmptyMessage(),toggleCheckoutButtonUsability("disable"))},cart={addToCart:addToCart,emptyCart:emptyCart,getCart:getCart,init:init};export{cart as default};