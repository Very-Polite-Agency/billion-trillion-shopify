{%- liquid

  assign section_name = 'age-gate'
  assign section_classes = section_name
  assign section_id = 'shopify-section-' | append: section_name

  assign aos_id = section_id | append: '--aos'
  assign aos_delay = 250
  assign aos_delay_increment = 250

  assign section_cookie_duration = section.settings.cookie_duration | default: 30
  assign section_enable = section.settings.enable | default: false

  assign section_modal_delay = section.settings.modal_delay
  assign section_modal_id = section_name
  assign section_modal_message = section.settings.modal_message
  assign section_modal_redirect_url = section.settings.modal_redirect_url | default: 'https://www.pbs.org'
  assign section_modal_success_message = section.settings.modal_success_message

-%}

{% if section_enable %}
  <div
    aria-hidden="true"
    class="{{ section_name }}__modal modal fade"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    data-delay="{{ section_modal_delay }}"
    data-cookie-duration="{{ section_cookie_duration }}"
    data-redirect-url="{{ section_modal_redirect_url }}"
    id="{{ section_name }}"
    tabindex="-1"
  >

    <div class="modal-background"></div>

    <div class="modal-dialog">
      <div class="modal-content text--uppercase body-copy--secondary">

        <div class='{{ section_name }}__content'>
          <div class='{{ section_name }}__svg'>{% render 'svg', type: 'icon.star-swirl' %}</div>
          <div class='{{ section_name }}__message body-copy--primary' id="{{ section_name }}--message">{{ section_modal_message }}</div>
          <div class='{{ section_name }}__success-message' id="{{ section_name }}--success-message">{{ section_modal_success_message }}</div>
        </div>

        <div class='{{ section_name }}__actions'>
          <button class='{{ section_name }}__button button--age-gate no' aria-label="Not of Age" data-of-age='no' type='button'>No</button>
          <button class='{{ section_name }}__button button--age-gate yes' aria-label="Of Age" data-of-age='yes' type='button'>Yes</button>
        </div>

      </div>
    </div>

  </div>
{% endif %}

{% schema %}
{
  "name": "Age Gate",
  "tag": "section",
  "class": "section section--age-gate age-gate",
  "settings": [
    {
      "content": "Modal",
      "type": "header"
    },
    {
      "label": "Modal Delay",
      "info": "Length of time (in milliseconds) before modal is shown.",
      "type": "range",
      "min": 3000,
      "max": 8000,
      "step": 250,
      "default": 4000,
      "id": "modal_delay"
    },
    {
      "label": "Modal Redirect URL",
      "info": "Optionally include an external URL to send people to if they are not of age.",
      "type": "url",
      "id": "modal_redirect_url"
    },
    {
		  "label": "Modal Message",
      "type": "richtext",
      "default": "<p>Are you over 21?</p>",
      "id": "modal_message"
    },
    {
      "label": "Modal Success Message",
      "type": "richtext",
      "default": "<p>Welcome to the Pleasuredome</p>",
      "id": "modal_success_message"
    },
    {
      "content": "Settings",
      "type": "header"
    },
    {
      "label": "Enable",
      "type": "checkbox",
      "default": true,
      "id": "enable"
    },
    {
      "label": "Cookie Duration",
      "info": "Length of time (in days) before cookie expires and user is re-prompted. Expiry date is assigned per browser and per device.",
      "type": "range",
      "min": 30,
      "max": 150,
      "step": 5,
      "default": 30,
      "id": "cookie_duration"
    }
  ]
}
{% endschema %}
