{%- liquid

  assign section_name = 'age-gate'
  assign section_classes = section_name
  assign section_id = 'shopify-section-' | append: section_name

  assign aos_id = section_id | append: '--aos'
  assign aos_delay = 250
  assign aos_delay_increment = 250

  assign cookie_duration = section.settings.cookie_duration | default: 30
  assign delay = section.settings.delay | default: 4000
  assign enable = section.settings.enable | default: false
  assign message = section.settings.message | default: 'Are you of Age?!'
  assign modal_id = section_name
  assign redirect_url = section.settings.redirect_url | default: 'https://www.pbs.org'
  assign success_message = section.settings.success_message | default: 'Welcome to the Pleasuredome'

-%}

{% if enable %}

  {%- style -%}
  {%- endstyle -%}

  <div
    class="{{ section_name }}__modal modal fade"
    id="{{ modal_id }}"
    aria-hidden="true"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    data-cookie-duration="{{ cookie_duration }}"
    data-delay="{{ delay }}"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="{{ section_name }}__modal-main">

          <div class='modal__content-frame'>
            <div class='modal__content'>
              <div class='modal__message message body-copy--age-gate'>
                <div class="modal__message-image">
                  <img src="{{ 'BILLION--age-gate-stars.svg' | asset_url }}" />
                </div>
                {{ message }}
              </div>
              <div class='modal__success-message message body-copy--age-gate' id="{{ section_name }}--success-message">
                {{ success_message }}
              </div>
            </div>
            <div class='modal__actions'>
              <button class='modal__button button--age-gate no' type='button' data-of-age='no'>No</button>
              <button class='modal__button button--age-gate yes' type='button' data-of-age='yes'>Yes</button>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

{% endif %}

{% schema %}
{
  "name": "Age Gate",
  "tag": "section",
  "class": "section section--age-gate age-gate",
  "settings": [
    {
      "content": "Settings",
      "type": "header"
    },
    {
      "label": "Enable",
      "type": "checkbox",
      "default": true,
      "id": "enable"
    },
    {
      "label": "Delay",
      "info": "Length of time (in milliseconds) before popup is shown.",
      "type": "range",
      "min": 3000,
      "max": 8000,
      "step": 250,
      "default": 4000,
      "id": "delay"
    },
    {
      "label": "Cookie Duration",
      "info": "Length of time (in days) before cookie expires and user is re-prompted. Expiry date is assigned per browser and per device.",
      "type": "range",
      "min": 30,
      "max": 150,
      "step": 5,
      "default": 30,
      "id": "cookie_duration"
    },
    {
      "label": "Redirect URL",
      "info": "Optionally include an external URL to send people to if they are not of age.",
      "type": "url",
      "id": "redirect_url"
    },
    {
      "content": "Content",
      "type": "header"
    },
    {
		  "label": "Message",
      "type": "richtext",
      "default": "<p>Are you over 21?</p>",
      "id": "message"
    },
    {
      "label": "Success Message",
      "type": "richtext",
      "default": "<p>Welcome to the Pleasuredome</p>",
      "id": "success_message"
    }
  ]
}
{% endschema %}
